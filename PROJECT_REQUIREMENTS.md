# 币安Alpha积分计算器 - 项目需求文档

## 项目概述

**项目名称**: 币安Alpha积分计算器  
**当前版本**: v1.0.0 (基础计算功能)  
**项目状态**: 前端计算器已完成，后端API功能已实现但未集成  
**技术栈**: Next.js 14 + TypeScript + React + Tailwind CSS  

## 当前已实现功能 ✅

### 1. 前端计算器界面
- **双语支持**: 中英文一键切换 (🌐 按钮)
- **实时计算**: 输入即时显示结果，无需点击按钮
- **响应式设计**: 适配各种屏幕尺寸
- **现代化UI**: 渐变背景 + 卡片设计

### 2. 核心计算功能
- **目标积分输入**: 用户设定想要达到的积分目标
- **余额输入**: 当前可用于交易的USD余额
- **交易次数计算**: 基于余额和目标自动计算所需交易次数
- **智能提示**: 
  - 已达成目标时显示恭喜信息
  - 无输入时显示等待提示
  - 有输入时实时显示计算结果

### 3. 积分规则说明
- **余额积分表**: 显示不同余额区间对应的积分
- **交易积分表**: 显示不同交易金额对应的积分  
- **计算公式展示**: 清晰说明积分计算逻辑
- **交易注意事项**: 买卖合并计算、磨损建议等

### 4. 计算逻辑规则
```typescript
// 余额积分规则
$100 - $1000    → 1分
$1000 - $10000  → 2分  
$10000 - $100000 → 3分
$100000+        → 4分

// 交易积分规则 (对数计算)
积分 = floor(log₂(交易金额))
$2 → 1分, $4 → 2分, $8 → 3分, $16 → 4分...
最高15分 ($32768)

// 交易计算
每次交易金额 = 用户余额 × 2
所需交易次数 = ceil(目标交易金额 ÷ 单次交易金额)
建议交易次数 = 所需次数 + 1 (防止磨损卡线)
```

## 已实现但未集成的功能 🔧

### 1. 后端API系统 (lib/)
- **币安API集成**: 已完成但前端未调用
- **数据库支持**: Prisma + SQLite，数据表结构完整
- **定时同步**: node-cron定时任务
- **交易数据处理**: 自动解析和统计币安订单
- **Alpha积分统计**: 按日汇总和历史查询

### 2. API路由 (app/api/)
- `POST /api/sync-alpha`: 同步币安交易数据
- `GET /api/sync-alpha`: 获取历史积分统计
- `POST /api/calculate-plan`: 计算交易计划

### 3. 脚本工具 (scripts/)
- `sync-cron.js`: 定时同步脚本
- `test-calculator.js`: 计算器测试脚本
- `setup.js`: 环境配置脚本

## 项目架构现状

```
当前架构:
前端页面 (page.tsx) 
├── 内置简化计算器类 ✅
├── 双语界面组件 ✅  
├── 实时计算逻辑 ✅
└── 积分规则展示 ✅

后端系统 (独立存在，未连接)
├── 币安API客户端 🔧
├── 数据库模型 🔧
├── API路由 🔧  
└── 定时任务 🔧
```

## 功能对比分析

| 功能模块 | 前端实现 | 后端实现 | 集成状态 |
|---------|---------|---------|---------|
| 积分计算 | ✅ 简化版本 | ✅ 完整版本 | ❌ 未连接 |
| 实时计算 | ✅ 前端计算 | ✅ API可用 | ❌ 未使用API |
| 历史数据 | ❌ 无数据 | ✅ 数据库存储 | ❌ 前端无显示 |
| 币安集成 | ❌ 无连接 | ✅ 完整集成 | ❌ 前端无调用 |
| 用户界面 | ✅ 现代化UI | ❌ 仅API | ✅ 界面完整 |

## 下一阶段开发计划 📋

### Phase 1: 数据集成 (优先级: HIGH)
- [ ] 连接前端和后端API
- [ ] 添加历史数据展示
- [ ] 实现实时数据同步
- [ ] 用户API配置界面

### Phase 2: 功能增强 (优先级: MEDIUM)  
- [ ] 历史积分趋势图表
- [ ] 交易记录详情页面
- [ ] 目标进度追踪
- [ ] 个人积分统计面板

### Phase 3: 高级功能 (优先级: LOW)
- [ ] 多账户支持
- [ ] 数据导出功能
- [ ] 邮件/消息通知
- [ ] 移动端优化

## 技术债务和改进点

### 1. 代码重构需求
- **计算逻辑统一**: 前端和后端存在两套计算逻辑，需要统一
- **类型定义**: 需要共享的TypeScript接口定义
- **API客户端**: 前端需要API调用封装

### 2. 用户体验优化
- **加载状态**: API调用时的loading状态
- **错误处理**: 网络错误和API错误的友好提示
- **数据缓存**: 减少不必要的API调用

### 3. 部署和配置
- **环境变量**: API密钥的安全管理
- **数据库迁移**: 生产环境数据库配置
- **构建优化**: 静态资源和代码分割

## 用户使用流程

### 当前用户流程 (v1.0)
1. 打开网页
2. 选择语言 (中/英)
3. 输入目标积分
4. 输入当前余额
5. 查看实时计算结果
6. 参考积分规则说明

### 计划用户流程 (v2.0)
1. 配置币安API密钥
2. 系统自动同步交易数据  
3. 查看当前积分状态
4. 设定目标等级
5. 获得个性化交易建议
6. 追踪进度和历史表现

## 项目文件结构

```
bn-data/
├── app/
│   ├── page.tsx              ✅ 主计算器界面
│   ├── layout.tsx           ✅ 布局配置
│   └── api/                 🔧 API路由 (已实现未使用)
├── lib/
│   ├── alpha-calculator.ts  🔧 完整计算逻辑
│   └── binance-client.ts    🔧 币安API客户端
├── scripts/                 🔧 工具脚本
├── prisma/                  🔧 数据库配置
└── components/ui/           ✅ UI组件库
```

## 结论

项目当前已经实现了一个功能完整的**前端计算器**，可以满足用户基本的积分计算需求。同时，后端系统也已经开发完成，具备完整的币安API集成和数据处理能力。

**下一步的关键任务**是将这两部分进行集成，让用户能够获得更加智能和个性化的积分计算体验。 